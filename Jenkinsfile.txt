pipeline {
    agent any
    
    stages {
        stage('1ï¸âƒ£ Clone Repository') {
            steps {
                echo 'ğŸ“¥ Clonage du repository Git...'
                checkout scm
                echo 'âœ… Clonage terminÃ©'
            }
        }
        
        stage('2ï¸âƒ£ Build Project') {
            steps {
                echo 'ğŸ”¨ Compilation du projet avec Maven...'
                script {
                    if (isUnix()) {
                        sh 'mvn clean compile'
                    } else {
                        bat 'mvn clean compile'
                    }
                }
                echo 'âœ… Compilation rÃ©ussie'
            }
        }
        
        stage('3ï¸âƒ£ Test & Package') {
            steps {
                echo 'ğŸ§ª Tests et packaging...'
                script {
                    if (isUnix()) {
                        sh 'mvn test package'
                    } else {
                        bat 'mvn test package'
                    }
                }
                echo 'âœ… Tests et packaging terminÃ©s'
            }
        }
    }
    
    post {
        success {
            echo 'ğŸ‰ Pipeline exÃ©cutÃ© avec succÃ¨s !'
            archiveArtifacts artifacts: 'target/*.jar', allowEmptyArchive: true
        }
        failure {
            echo 'âŒ Le pipeline a Ã©chouÃ©'
        }
    }
}